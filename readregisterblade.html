<html>
<head>
<title>
LÃ¦s registerblade
</title>
<script src="json_sans_eval.js"></script>
</head>
<body>
<script>
function reqListenerPerson () {
	// Parse the address search, there should be many results
	var myJson = this.responseText;
	var myJsonObj = jsonParse(myJson);
	var count = 0;
	for (var k in myJsonObj) {
  		//alert(l + '=' + myJsonObj[k][l]);
		alert('id=' + myJsonObj[k].id);
		alert('registerblad_id=' + myJsonObj[k].registerblad_id);
		
		//we have the registerblad_id, get the person
		count++;
	}
}

function reqListenerAddresses () {
	// Parse the address search, there should be many results
	var myJson = this.responseText;
	var myJsonObj = jsonParse(myJson);
	var count = 0;
	for (var k in myJsonObj) {
  		//alert(l + '=' + myJsonObj[k][l]);
		alert('id=' + myJsonObj[k].id);
		alert('registerblad_id=' + myJsonObj[k].registerblad_id);
		
		//we have the registerblad_id, get the person
		count++;
	}
}

function reqListenerRoad () {
	// Parse the road search, there should be only one result
	var myJson = this.responseText;
	var myJsonObj = jsonParse(myJson);
	var count = 0;
	for (var k in myJsonObj) {
  		//alert(l + '=' + myJsonObj[k][l]);
  		
  		switch (count)
  		{
  			case 0:
  				alert('id=' + myJsonObj[k].id);
  				alert('name=' + myJsonObj[k].name);
  				
  				// we have the road id, get the addresses for the road number 
				var oReq = new XMLHttpRequest();
				oReq.onload = reqListenerAddresses;
				oReq.open("get", "http://www.politietsregisterblade.dk/api/1/?type=address&road_id=1708&number=1", true);
				oReq.send();
  				break;
  			case 1:
  				alert('results=' + myJsonObj[k].results);
  				break;
  		}
		count++;
	}
}

var oReq = new XMLHttpRequest();
oReq.onload = reqListenerRoad;
oReq.open("get", "http://www.politietsregisterblade.dk/api/1/?type=road&name=poppelgade&limitstart=0&limit=1", true);
oReq.send();
</script>
</body>
</html>